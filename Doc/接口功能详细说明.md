# 接口功能详细说明

---

## 基础接口

1. 注册接口
    接受前端传来的username和password，查询数据库中是否存在相同用户数据，若存在则返回错误信息，若不存在则将条数据插入到用户表中，并使用返回的userid生成token返回给前端
2. 登录接口
3. 视频流接口
    接受前端传过来的token和latest_time,两个都可为空,
    如果有token则调用用户的视频流服务需要额外查询对视频是否喜欢和对作者是否关注
    此外latest_time作为限制条件后台返回比这个时间更早的视频避免拿到重复的视频
4. 视频投稿接口
    接受前端传过来的token和title,两个都是必须的,此外还有用户上传的视频File文件
    解码token,如果解码失败或者为空则返回Encryption failed,否则拿到userId去查询是否有这个用户
    1.没有
        报用户不存在信息给前端
    2.有
        打开File文件实体并上传到服务器返回视频链接和视频第一针封面的链接插入到数据库
        1.出错
            报错误信息给前端
        2.没出错
            插入成功,statusCode=0
5. 发布列表接口
    
    先根据userId查询出用户的所有视频以及视频的作者信息，响应的数据中，是否关注作者和是否点赞视频需要额外查询：
    - 查询是否关注作者，有两种情况：
      - token不为空：先解析出token中的userId，再根据此id和作者id查询是否关注
      - token为空则无需任何操作，默认的零值为未关注
    - 查询是否点赞视频，和查询是否关注作者类似。

    所有响应信息查询完毕后，填装返回即可。
    
6. 用户信息接口

    利用前端传递userid和token，判断是否传递这两个参数，如果没有抛出错误，如果有，先根据token获取当前登录用户的id
    在根据用户id和要查询的userid查询是否关注（也就是用户id是否关注了要查询的userid），然后查出userid的用户信息，返回用户信息数据
## 扩展接口|

1. 赞操作
2. 点赞列表
3. 评论操作
    根据前端传来的vedioId查询相应的评论列表，在分别查询每个评论数据相应的用户数据并装填到返回体中，最后返回给全段
4. 视频评论列表

## 扩展接口||

1. 关注操作
2. 用户关注列表
    先根据userId查询出该用户的关注列表，再根据token中的userId查询当前用户是否关注了列表中的用户。
    - 当token不为空时：先解析出token中的userId，再根据此id和列表中的用户id查询是否关注
    - 当token为空时无需任何操作，默认的零值为未关注。

    所有响应信息查询完毕后，填装返回即可。
    
3. 用户粉丝列表

    根据前端传递userid和token，先根据userid查出该userid的粉丝列表，再根据token获取当前登录用户的id
    查询当前用户是否关注的用户列表，再使用二分查找 找出对粉丝列表中包含当前登录用户的关注用户，
    这样可以减少调用数据库接口查询当前用户是否有关注粉丝列表中的客户，只需要查一次数据库，大大增加效率，减小数据库查询压力